<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Define communication messages for the vhost-user protocol."><meta name="keywords" content="rust, rustlang, rust-lang, message"><title>vmm_vhost::message - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings" ></script><script src="../../storage.js"></script><script src="../../crates.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../vmm_vhost/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><h2 class="location">Module message</h2><div class="sidebar-elems"><div class="block items"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#constants">Constants</a></li><li><a href="#traits">Traits</a></li><li><a href="#types">Type Definitions</a></li></ul></div><div id="sidebar-vars" data-name="message" data-ty="mod" data-relpath="./"></div><script defer src="./sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../../wheel.svg"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Module <a href="../index.html">vmm_vhost</a>::<wbr><a class="mod" href="#">message</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/vmm_vhost/message.rs.html#4-1272" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Define communication messages for the vhost-user protocol.</p>
<p>For message definition, please refer to the <a href="https://github.com/qemu/qemu/blob/f7526eece29cd2e36a63b6703508b24453095eb8/docs/interop/vhost-user.txt">vhost-user spec</a>.</p>
</div></details><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="struct" href="struct.DescStatePacked.html" title="vmm_vhost::message::DescStatePacked struct">DescStatePacked</a></div><div class="item-right docblock-short"><p>Inflight I/O descriptor state for packed virtqueues</p>
</div><div class="item-left module-item"><a class="struct" href="struct.DescStateSplit.html" title="vmm_vhost::message::DescStateSplit struct">DescStateSplit</a></div><div class="item-right docblock-short"><p>Inflight I/O descriptor state for split virtqueues</p>
</div><div class="item-left module-item"><a class="struct" href="struct.QueueRegionPacked.html" title="vmm_vhost::message::QueueRegionPacked struct">QueueRegionPacked</a></div><div class="item-right docblock-short"><p>Inflight I/O queue region for packed virtqueues</p>
</div><div class="item-left module-item"><a class="struct" href="struct.QueueRegionSplit.html" title="vmm_vhost::message::QueueRegionSplit struct">QueueRegionSplit</a></div><div class="item-right docblock-short"><p>Inflight I/O queue region for split virtqueues</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserConfig.html" title="vmm_vhost::message::VhostUserConfig struct">VhostUserConfig</a></div><div class="item-right docblock-short"><p>Message to read/write device configuration space.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserConfigFlags.html" title="vmm_vhost::message::VhostUserConfigFlags struct">VhostUserConfigFlags</a></div><div class="item-right docblock-short"><p>Flags for the device configuration message.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserFSSlaveMsg.html" title="vmm_vhost::message::VhostUserFSSlaveMsg struct">VhostUserFSSlaveMsg</a></div><div class="item-right docblock-short"><p>Slave request message to update the MMIO window.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserFSSlaveMsgFlags.html" title="vmm_vhost::message::VhostUserFSSlaveMsgFlags struct">VhostUserFSSlaveMsgFlags</a></div><div class="item-right docblock-short"><p>Flags for virtio-fs slave messages.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserHeaderFlag.html" title="vmm_vhost::message::VhostUserHeaderFlag struct">VhostUserHeaderFlag</a></div><div class="item-right docblock-short"><p>Common message flags for vhost-user requests and replies.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserInflight.html" title="vmm_vhost::message::VhostUserInflight struct">VhostUserInflight</a></div><div class="item-right docblock-short"><p>Single memory region descriptor as payload for ADD_MEM_REG and REM_MEM_REG
requests.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserMemory.html" title="vmm_vhost::message::VhostUserMemory struct">VhostUserMemory</a></div><div class="item-right docblock-short"><p>Memory region descriptor for the SET_MEM_TABLE request.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserMemoryRegion.html" title="vmm_vhost::message::VhostUserMemoryRegion struct">VhostUserMemoryRegion</a></div><div class="item-right docblock-short"><p>Memory region descriptors as payload for the SET_MEM_TABLE request.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserMsgHeader.html" title="vmm_vhost::message::VhostUserMsgHeader struct">VhostUserMsgHeader</a></div><div class="item-right docblock-short"><p>Common message header for vhost-user requests and replies.
A vhost-user message consists of 3 header fields and an optional payload. All numbers are in the
machine native byte order.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserProtocolFeatures.html" title="vmm_vhost::message::VhostUserProtocolFeatures struct">VhostUserProtocolFeatures</a></div><div class="item-right docblock-short"><p>Vhost-user protocol feature flags.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserSingleMemoryRegion.html" title="vmm_vhost::message::VhostUserSingleMemoryRegion struct">VhostUserSingleMemoryRegion</a></div><div class="item-right docblock-short"><p>Single memory region descriptor as payload for ADD_MEM_REG and REM_MEM_REG
requests.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserU64.html" title="vmm_vhost::message::VhostUserU64 struct">VhostUserU64</a></div><div class="item-right docblock-short"><p>A generic message to encapsulate a 64-bit value.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserVirtioFeatures.html" title="vmm_vhost::message::VhostUserVirtioFeatures struct">VhostUserVirtioFeatures</a></div><div class="item-right docblock-short"><p>Transport specific flags in VirtIO feature set defined by vhost-user.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserVringAddr.html" title="vmm_vhost::message::VhostUserVringAddr struct">VhostUserVringAddr</a></div><div class="item-right docblock-short"><p>Vring address descriptor.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserVringAddrFlags.html" title="vmm_vhost::message::VhostUserVringAddrFlags struct">VhostUserVringAddrFlags</a></div><div class="item-right docblock-short"><p>Flags for vring address.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.VhostUserVringState.html" title="vmm_vhost::message::VhostUserVringState struct">VhostUserVringState</a></div><div class="item-right docblock-short"><p>Vring state descriptor.</p>
</div></div><h2 id="enums" class="section-header"><a href="#enums">Enums</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="enum" href="enum.MasterReq.html" title="vmm_vhost::message::MasterReq enum">MasterReq</a></div><div class="item-right docblock-short"><p>Type of requests sending from masters to slaves.</p>
</div><div class="item-left module-item"><a class="enum" href="enum.SlaveReq.html" title="vmm_vhost::message::SlaveReq enum">SlaveReq</a></div><div class="item-right docblock-short"><p>Type of requests sending from slaves to masters.</p>
</div></div><h2 id="constants" class="section-header"><a href="#constants">Constants</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="constant" href="constant.MAX_ATTACHED_FD_ENTRIES.html" title="vmm_vhost::message::MAX_ATTACHED_FD_ENTRIES constant">MAX_ATTACHED_FD_ENTRIES</a></div><div class="item-right docblock-short"><p>The VhostUserMemory message has variable message size and variable number of attached file
descriptors. Each user memory region entry in the message payload occupies 32 bytes,
so setting maximum number of attached file descriptors based on the maximum message size.
But rust only implements Default and AsMut traits for arrays with 0 - 32 entries, so further
reduce the maximum number…</p>
</div><div class="item-left module-item"><a class="constant" href="constant.MAX_MSG_SIZE.html" title="vmm_vhost::message::MAX_MSG_SIZE constant">MAX_MSG_SIZE</a></div><div class="item-right docblock-short"><p>The vhost-user specification uses a field of u32 to store message length.
On the other hand, preallocated buffers are needed to receive messages from the Unix domain
socket. To preallocating a 4GB buffer for each vhost-user message is really just an overhead.
Among all defined vhost-user messages, only the VhostUserConfig and VhostUserMemory has variable
message size. For the VhostUserConfig, a maximum size of 4K is enough because the user
configuration space for virtio devices is (4K - 0x100) bytes at most. For the VhostUserMemory,
4K should be enough too because it can support 255 memory regions at most.</p>
</div><div class="item-left module-item"><a class="constant" href="constant.VHOST_USER_CONFIG_OFFSET.html" title="vmm_vhost::message::VHOST_USER_CONFIG_OFFSET constant">VHOST_USER_CONFIG_OFFSET</a></div><div class="item-right docblock-short"><p>Starting position (inclusion) of the device configuration space in virtio devices.</p>
</div><div class="item-left module-item"><a class="constant" href="constant.VHOST_USER_CONFIG_SIZE.html" title="vmm_vhost::message::VHOST_USER_CONFIG_SIZE constant">VHOST_USER_CONFIG_SIZE</a></div><div class="item-right docblock-short"><p>Ending position (exclusion) of the device configuration space in virtio devices.</p>
</div><div class="item-left module-item"><a class="constant" href="constant.VHOST_USER_FS_SLAVE_ENTRIES.html" title="vmm_vhost::message::VHOST_USER_FS_SLAVE_ENTRIES constant">VHOST_USER_FS_SLAVE_ENTRIES</a></div><div class="item-right docblock-short"><p>Max entries in one virtio-fs slave request.</p>
</div><div class="item-left module-item"><a class="constant" href="constant.VHOST_USER_MAX_VRINGS.html" title="vmm_vhost::message::VHOST_USER_MAX_VRINGS constant">VHOST_USER_MAX_VRINGS</a></div><div class="item-right docblock-short"><p>Maximum number of vrings supported.</p>
</div></div><h2 id="traits" class="section-header"><a href="#traits">Traits</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="trait" href="trait.Req.html" title="vmm_vhost::message::Req trait">Req</a></div><div class="item-right docblock-short"><p>Used for the payload in Vhost Master messages.</p>
</div><div class="item-left module-item"><a class="trait" href="trait.VhostUserMsgValidator.html" title="vmm_vhost::message::VhostUserMsgValidator trait">VhostUserMsgValidator</a></div><div class="item-right docblock-short"><p>Vhost message Validator.</p>
</div></div><h2 id="types" class="section-header"><a href="#types">Type Definitions</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="type" href="type.VhostUserConfigPayload.html" title="vmm_vhost::message::VhostUserConfigPayload type">VhostUserConfigPayload</a></div><div class="item-right docblock-short"><p>Payload for the VhostUserConfig message.</p>
</div><div class="item-left module-item"><a class="type" href="type.VhostUserMemoryPayload.html" title="vmm_vhost::message::VhostUserMemoryPayload type">VhostUserMemoryPayload</a></div><div class="item-right docblock-short"><p>Payload of the VhostUserMemory message.</p>
</div></div></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../../" data-current-crate="vmm_vhost" data-search-index-js="../../search-index.js" data-search-js="../../search.js"></div>
    <script src="../../main.js"></script>
</body></html>